Создать роль:
curl -X POST http://localhost:8080/roles -H "Content-Type: application/json" -d '{"id":"id_1","role":"parent"}'

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Принять платёж(внутренне):
curl -X POST http://localhost:8080/payment -H "Content-Type: application/json" -d '{"id":"id_1","role":"parent","amount":1500,"quantity":2}'

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Посмотреть все платежи:
curl http://localhost:8080/payments

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Получить список сохранённых карт (AirbaPay):
curl -X GET http://localhost:8080/cards/account_1 \
  -H "Authorization: Bearer <access_token>"

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Сохранить карту (получить redirect):
curl -X POST http://localhost:8080/cards \
  -H "Authorization: Bearer <access_token>" \
  -H "Content-Type: application/json" \
  -d '{"account_id": "account_1"}'

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Создать платёж по сохранённой карте:
curl -X POST http://localhost:8080/payment/card/your_card_id \
  -H "Authorization: Bearer <access_token>" \
  -H "Content-Type: application/json" \
  -d '{"invoice_id": "inv_123", "amount": 2500, "currency": "KZT", "account_id": "account_1"}'

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Авторизация и получение токена:
curl -X POST https://ps.airbapay.kz/acquiring-api/api/v1/auth/sign-in \
  -H "Content-Type: application/json" \
  -d '{"user":"merchant", "password":"777", "terminal_id":"asa2323dasdas33dwdq"}'

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Проверка статуса платежа:
curl -X GET http://localhost:8080/payment-status/payment_id \
  -H "Authorization: Bearer <access_token>"

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Получение платежей пользователя:
curl http://localhost:8080/payments/id_1/parent

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Удаление сохранённой карты:
curl -X DELETE http://localhost:8080/cards/card_id_here \
  -H "Authorization: Bearer <access_token>"

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Создание платежа (открытие страницы оплаты):
curl -X POST http://localhost:8080/airba/payments \
  -H "Authorization: Bearer <access_token>" \
  -H "Content-Type: application/json" \
  -d '{"invoice_id": "inv_123", "amount": 2500, "currency": "KZT", "account_id": "account_1"}'

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Платёж по сохранённой карте (без ввода CVV):
curl -X POST http://localhost:8080/payment/card/your_card_id \
  -H "Authorization: Bearer <access_token>" \
  -H "Content-Type: application/json" \
  -d '{"invoice_id": "inv_456", "amount": 4000, "currency": "KZT", "account_id": "account_1"}'

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Рекуррентный платёж (повторный платёж):
curl -X POST http://localhost:8080/airba/recurring \
  -H "Authorization: Bearer <access_token>" \
  -H "Content-Type: application/json" \
  -d '{"invoice_id": "rec_001", "amount": 1000, "currency": "KZT", "account_id": "account_1", "card_id": "card_id_here"}'

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Завершение двухстадийного платежа (Charge):
curl -X POST http://localhost:8080/airba/charge \
  -H "Authorization: Bearer <access_token>" \
  -H "Content-Type: application/json" \
  -d '{"payment_id": "63eae27b42498"}'

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Возврат платежа (Return):
curl -X POST http://localhost:8080/airba/return \
  -H "Authorization: Bearer <access_token>" \
  -H "Content-Type: application/json" \
  -d '{"payment_id": "63eae27b42498", "amount": 500}'

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Получение статуса платежа:
curl -X GET http://localhost:8080/payment-status/63eae27b42498 \
  -H "Authorization: Bearer <access_token>"

----------------------------------------------------------------------------------------------------------------------------------------------------------------------

Тест Webhook:

Webhook вызывается AirbaPay при обновлении статуса платежа. Пример JSON:
{
  "id": "airba_payment_id",
  "invoice_id": "inv_123",
  "amount": 2500,
  "currency": "KZT",
  "status": "success",
  "description": "Paid successfully",
  "signature": "base64_signature"
}

Публичный ключ подписи:
https://sps.airbapay.kz/acquiring/sign/public.pem